{"ast":null,"code":"'use strict';\n\nvar exponentialBackoffWithJitter = require('./exponential_backoff_with_jitter');\n\nvar objectToQueryParamString = require('./object_to_query_param_string');\n\nvar packageVersion = require('./package_version'); // This will become require('xhr') in the browser.\n\n\nvar request = require('request');\n\nvar userAgent = 'Airtable.js/' + packageVersion;\n\nfunction runAction(base, method, path, queryParams, bodyData, callback, numAttempts) {\n  var url = base._airtable._endpointUrl + '/v' + base._airtable._apiVersionMajor + '/' + base._id + path + '?' + objectToQueryParamString(queryParams);\n  var headers = {\n    authorization: 'Bearer ' + base._airtable._apiKey,\n    'x-api-version': base._airtable._apiVersion,\n    'x-airtable-application-id': base.getId()\n  };\n  var isBrowser = typeof window !== 'undefined'; // Some browsers do not allow overriding the user agent.\n  // https://github.com/Airtable/airtable.js/issues/52\n\n  if (isBrowser) {\n    headers['x-airtable-user-agent'] = userAgent;\n  } else {\n    headers['User-Agent'] = userAgent;\n  }\n\n  var options = {\n    method: method.toUpperCase(),\n    url: url,\n    json: true,\n    timeout: base._airtable.requestTimeout,\n    headers: headers\n  };\n\n  if (bodyData !== null) {\n    options.body = bodyData;\n  }\n\n  request(options, function (error, resp, body) {\n    if (error) {\n      callback(error, resp, body);\n      return;\n    }\n\n    if (resp.statusCode === 429 && !base._airtable._noRetryIfRateLimited) {\n      var backoffDelayMs = exponentialBackoffWithJitter(numAttempts);\n      setTimeout(function () {\n        runAction(base, method, path, queryParams, bodyData, callback, numAttempts + 1);\n      }, backoffDelayMs);\n      return;\n    }\n\n    error = base._checkStatusForError(resp.statusCode, body);\n    callback(error, resp, body);\n  });\n}\n\nmodule.exports = runAction;","map":{"version":3,"sources":["/home/hettiemcc/documents/fac/projects/teach-fish-frontend/node_modules/airtable/lib/run_action.js"],"names":["exponentialBackoffWithJitter","require","objectToQueryParamString","packageVersion","request","userAgent","runAction","base","method","path","queryParams","bodyData","callback","numAttempts","url","_airtable","_endpointUrl","_apiVersionMajor","_id","headers","authorization","_apiKey","_apiVersion","getId","isBrowser","window","options","toUpperCase","json","timeout","requestTimeout","body","error","resp","statusCode","_noRetryIfRateLimited","backoffDelayMs","setTimeout","_checkStatusForError","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,4BAA4B,GAAGC,OAAO,CAAC,mCAAD,CAA1C;;AACA,IAAIC,wBAAwB,GAAGD,OAAO,CAAC,gCAAD,CAAtC;;AACA,IAAIE,cAAc,GAAGF,OAAO,CAAC,mBAAD,CAA5B,C,CAEA;;;AACA,IAAIG,OAAO,GAAGH,OAAO,CAAC,SAAD,CAArB;;AAEA,IAAII,SAAS,GAAG,iBAAiBF,cAAjC;;AAEA,SAASG,SAAT,CAAmBC,IAAnB,EAAyBC,MAAzB,EAAiCC,IAAjC,EAAuCC,WAAvC,EAAoDC,QAApD,EAA8DC,QAA9D,EAAwEC,WAAxE,EAAqF;AACjF,MAAIC,GAAG,GACHP,IAAI,CAACQ,SAAL,CAAeC,YAAf,GACA,IADA,GAEAT,IAAI,CAACQ,SAAL,CAAeE,gBAFf,GAGA,GAHA,GAIAV,IAAI,CAACW,GAJL,GAKAT,IALA,GAMA,GANA,GAOAP,wBAAwB,CAACQ,WAAD,CAR5B;AAUA,MAAIS,OAAO,GAAG;AACVC,IAAAA,aAAa,EAAE,YAAYb,IAAI,CAACQ,SAAL,CAAeM,OADhC;AAEV,qBAAiBd,IAAI,CAACQ,SAAL,CAAeO,WAFtB;AAGV,iCAA6Bf,IAAI,CAACgB,KAAL;AAHnB,GAAd;AAKA,MAAIC,SAAS,GAAG,OAAOC,MAAP,KAAkB,WAAlC,CAhBiF,CAiBjF;AACA;;AACA,MAAID,SAAJ,EAAe;AACXL,IAAAA,OAAO,CAAC,uBAAD,CAAP,GAAmCd,SAAnC;AACH,GAFD,MAEO;AACHc,IAAAA,OAAO,CAAC,YAAD,CAAP,GAAwBd,SAAxB;AACH;;AAED,MAAIqB,OAAO,GAAG;AACVlB,IAAAA,MAAM,EAAEA,MAAM,CAACmB,WAAP,EADE;AAEVb,IAAAA,GAAG,EAAEA,GAFK;AAGVc,IAAAA,IAAI,EAAE,IAHI;AAIVC,IAAAA,OAAO,EAAEtB,IAAI,CAACQ,SAAL,CAAee,cAJd;AAKVX,IAAAA,OAAO,EAAEA;AALC,GAAd;;AAQA,MAAIR,QAAQ,KAAK,IAAjB,EAAuB;AACnBe,IAAAA,OAAO,CAACK,IAAR,GAAepB,QAAf;AACH;;AAEDP,EAAAA,OAAO,CAACsB,OAAD,EAAU,UAASM,KAAT,EAAgBC,IAAhB,EAAsBF,IAAtB,EAA4B;AACzC,QAAIC,KAAJ,EAAW;AACPpB,MAAAA,QAAQ,CAACoB,KAAD,EAAQC,IAAR,EAAcF,IAAd,CAAR;AACA;AACH;;AAED,QAAIE,IAAI,CAACC,UAAL,KAAoB,GAApB,IAA2B,CAAC3B,IAAI,CAACQ,SAAL,CAAeoB,qBAA/C,EAAsE;AAClE,UAAIC,cAAc,GAAGpC,4BAA4B,CAACa,WAAD,CAAjD;AACAwB,MAAAA,UAAU,CAAC,YAAW;AAClB/B,QAAAA,SAAS,CAACC,IAAD,EAAOC,MAAP,EAAeC,IAAf,EAAqBC,WAArB,EAAkCC,QAAlC,EAA4CC,QAA5C,EAAsDC,WAAW,GAAG,CAApE,CAAT;AACH,OAFS,EAEPuB,cAFO,CAAV;AAGA;AACH;;AAEDJ,IAAAA,KAAK,GAAGzB,IAAI,CAAC+B,oBAAL,CAA0BL,IAAI,CAACC,UAA/B,EAA2CH,IAA3C,CAAR;AACAnB,IAAAA,QAAQ,CAACoB,KAAD,EAAQC,IAAR,EAAcF,IAAd,CAAR;AACH,GAhBM,CAAP;AAiBH;;AAEDQ,MAAM,CAACC,OAAP,GAAiBlC,SAAjB","sourcesContent":["'use strict';\n\nvar exponentialBackoffWithJitter = require('./exponential_backoff_with_jitter');\nvar objectToQueryParamString = require('./object_to_query_param_string');\nvar packageVersion = require('./package_version');\n\n// This will become require('xhr') in the browser.\nvar request = require('request');\n\nvar userAgent = 'Airtable.js/' + packageVersion;\n\nfunction runAction(base, method, path, queryParams, bodyData, callback, numAttempts) {\n    var url =\n        base._airtable._endpointUrl +\n        '/v' +\n        base._airtable._apiVersionMajor +\n        '/' +\n        base._id +\n        path +\n        '?' +\n        objectToQueryParamString(queryParams);\n\n    var headers = {\n        authorization: 'Bearer ' + base._airtable._apiKey,\n        'x-api-version': base._airtable._apiVersion,\n        'x-airtable-application-id': base.getId(),\n    };\n    var isBrowser = typeof window !== 'undefined';\n    // Some browsers do not allow overriding the user agent.\n    // https://github.com/Airtable/airtable.js/issues/52\n    if (isBrowser) {\n        headers['x-airtable-user-agent'] = userAgent;\n    } else {\n        headers['User-Agent'] = userAgent;\n    }\n\n    var options = {\n        method: method.toUpperCase(),\n        url: url,\n        json: true,\n        timeout: base._airtable.requestTimeout,\n        headers: headers,\n    };\n\n    if (bodyData !== null) {\n        options.body = bodyData;\n    }\n\n    request(options, function(error, resp, body) {\n        if (error) {\n            callback(error, resp, body);\n            return;\n        }\n\n        if (resp.statusCode === 429 && !base._airtable._noRetryIfRateLimited) {\n            var backoffDelayMs = exponentialBackoffWithJitter(numAttempts);\n            setTimeout(function() {\n                runAction(base, method, path, queryParams, bodyData, callback, numAttempts + 1);\n            }, backoffDelayMs);\n            return;\n        }\n\n        error = base._checkStatusForError(resp.statusCode, body);\n        callback(error, resp, body);\n    });\n}\n\nmodule.exports = runAction;\n"]},"metadata":{},"sourceType":"script"}