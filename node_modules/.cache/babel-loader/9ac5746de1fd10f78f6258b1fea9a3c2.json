{"ast":null,"code":"var _jsxFileName = \"/home/hettiemcc/documents/fac/projects/teach-fish-frontend/src/pages/signUpPage/SignUp.js\";\nimport React, { useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport Heading from \"../../components/global/heading/Heading\";\nimport { DropdownCountries, DropdownGender } from \"../../components/global/forms/dropdown/Dropdown\";\nimport DateInput from \"../../components/global/forms/dateInput/DateInput\";\nimport { TextButton } from \"../../components/global/buttons/Buttons\";\nimport { FormContainer, FormInputWrapper } from \"./SignUp.style\";\nimport { AppContext } from \"../../utils/AppContext\"; // import fetchStudentRecords from \"../../utils/fetch-data\";\n\nconst SignUp = () => {\n  const {\n    isUserInfoComplete,\n    setIsUserInfoComplete\n  } = useContext(AppContext);\n  const {\n    loginInfo,\n    setLoginInfo\n  } = useContext(AppContext); // const { isUserInfoComplete, setIsUserInfoComplete } = React.useState();\n  // const { loginInfo, setLoginInfo } = React.useState({\n  //   name: \"\",\n  //   email: \"\",\n  // });\n\n  const history = useHistory();\n  const token = JSON.parse(localStorage.getItem(\"token\"));\n  const name = token ? token.full_name : \"\";\n  const email = token ? token.email : \"\";\n  const [form, setForm] = React.useState({\n    Name: name,\n    Email: email,\n    dob: \"\",\n    gender: \"\",\n    country: \"\"\n  });\n\n  const handleChange = event => {\n    const {\n      name,\n      value\n    } = event.target;\n    setForm({ ...form,\n      [name]: value\n    });\n  };\n\n  const handleSubmit = async event => {\n    event.preventDefault();\n    await fetch(\"../../../.netlify/functions/post-student/post-student.js\", {\n      method: \"POST\",\n      headers: {\n        \"content-type\": \"application/json\"\n      },\n      body: JSON.stringify(form)\n    });\n    history.push(\"/my-missions\");\n  }; // Retreive data from airtable, then check if user is already registered with all neccessary information\n\n\n  React.useEffect(() => {\n    // get user email from state\n    let userEmail = loginInfo.email;\n\n    const func = async () => {\n      const post = await fetch(`../../../.netlify/functions/fetch-student/fetch-student.js?email=${userEmail}`);\n      const finalFetch = await post.json();\n      setIsUserInfoComplete(finalFetch);\n    };\n\n    func();\n  }, [loginInfo]);\n  React.useEffect(() => {\n    if (isUserInfoComplete) {\n      return history.push(\"/my-missions\");\n    }\n  }, [isUserInfoComplete]);\n  React.useEffect(() => {\n    const token = JSON.parse(localStorage.getItem(\"token\"));\n\n    if (token) {\n      setLoginInfo({\n        email: token.email,\n        name: token.full_name\n      });\n    }\n  }, [setLoginInfo]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Heading, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  }, \"Before you begin...\"), /*#__PURE__*/React.createElement(FormContainer, {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(FormInputWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DateInput, {\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(FormInputWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DropdownCountries, {\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(FormInputWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DropdownGender, {\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(TextButton, {\n    type: \"submit\",\n    text: \"Get started!\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default SignUp;","map":{"version":3,"sources":["/home/hettiemcc/documents/fac/projects/teach-fish-frontend/src/pages/signUpPage/SignUp.js"],"names":["React","useContext","useHistory","Heading","DropdownCountries","DropdownGender","DateInput","TextButton","FormContainer","FormInputWrapper","AppContext","SignUp","isUserInfoComplete","setIsUserInfoComplete","loginInfo","setLoginInfo","history","token","JSON","parse","localStorage","getItem","name","full_name","email","form","setForm","useState","Name","Email","dob","gender","country","handleChange","event","value","target","handleSubmit","preventDefault","fetch","method","headers","body","stringify","push","useEffect","userEmail","func","post","finalFetch","json"],"mappings":"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","sourcesContent":["import React, { useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport Heading from \"../../components/global/heading/Heading\";\nimport {\n  DropdownCountries,\n  DropdownGender,\n} from \"../../components/global/forms/dropdown/Dropdown\";\nimport DateInput from \"../../components/global/forms/dateInput/DateInput\";\nimport { TextButton } from \"../../components/global/buttons/Buttons\";\nimport { FormContainer, FormInputWrapper } from \"./SignUp.style\";\nimport { AppContext } from \"../../utils/AppContext\";\n// import fetchStudentRecords from \"../../utils/fetch-data\";\n\nconst SignUp = () => {\n  const { isUserInfoComplete, setIsUserInfoComplete } = useContext(AppContext);\n  const { loginInfo, setLoginInfo } = useContext(AppContext);\n  // const { isUserInfoComplete, setIsUserInfoComplete } = React.useState();\n  // const { loginInfo, setLoginInfo } = React.useState({\n  //   name: \"\",\n  //   email: \"\",\n  // });\n\n  const history = useHistory();\n  const token = JSON.parse(localStorage.getItem(\"token\"));\n\n  const name = token ? token.full_name : \"\";\n  const email = token ? token.email : \"\";\n\n  const [form, setForm] = React.useState({\n    Name: name,\n    Email: email,\n    dob: \"\",\n    gender: \"\",\n    country: \"\",\n  });\n\n  const handleChange = (event) => {\n    const { name, value } = event.target;\n    setForm({ ...form, [name]: value });\n  };\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n\n    await fetch(\"../../../.netlify/functions/post-student/post-student.js\", {\n      method: \"POST\",\n      headers: {\n        \"content-type\": \"application/json\",\n      },\n      body: JSON.stringify(form),\n    });\n    history.push(\"/my-missions\");\n  };\n\n  // Retreive data from airtable, then check if user is already registered with all neccessary information\n  React.useEffect(() => {\n    // get user email from state\n    let userEmail = loginInfo.email;\n\n    const func = async () => {\n      const post = await fetch(\n        `../../../.netlify/functions/fetch-student/fetch-student.js?email=${userEmail}`,\n      );\n\n      const finalFetch = await post.json();\n      setIsUserInfoComplete(finalFetch);\n    };\n\n    func();\n  }, [loginInfo]);\n\n  React.useEffect(() => {\n    if (isUserInfoComplete) {\n      return history.push(\"/my-missions\");\n    }\n  }, [isUserInfoComplete]);\n\n  React.useEffect(() => {\n    const token = JSON.parse(localStorage.getItem(\"token\"));\n    if (token) {\n      setLoginInfo({\n        email: token.email,\n        name: token.full_name,\n      });\n    }\n  }, [setLoginInfo]);\n\n  return (\n    <>\n      <Heading>Before you begin...</Heading>\n      <FormContainer onSubmit={handleSubmit}>\n        <FormInputWrapper>\n          <DateInput onChange={handleChange} />\n        </FormInputWrapper>\n        <FormInputWrapper>\n          <DropdownCountries onChange={handleChange} />\n        </FormInputWrapper>\n        <FormInputWrapper>\n          <DropdownGender onChange={handleChange} />\n        </FormInputWrapper>\n        <TextButton type={\"submit\"} text={\"Get started!\"} />\n      </FormContainer>\n    </>\n  );\n};\n\nexport default SignUp;\n"]},"metadata":{},"sourceType":"module"}