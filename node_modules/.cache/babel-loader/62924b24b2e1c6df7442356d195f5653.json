{"ast":null,"code":"const Airtable = require(\"airtable\"); // export REACT_APP_AIRTABLE_API_KEY=keyOIINSZ9ehyF6Cz\n// export REACT_APP_AIRTABLE_BASE_ID=appiR8DpsnVuhNHj4\n// export REACT_APP_AIRTABLE_API_URL=https://api.airtable.com/v0/\n// const {\n//   REACT_APP_AIRTABLE_API_KEY,\n//   REACT_APP_AIRTABLE_BASE_ID,\n//   REACT_APP_AIRTABLE_API_URL,\n// } = process.env;\n\n\nconst base = new Airtable({\n  endpointUrl: \"https://api.airtable.com\",\n  apiKey: \"keyOIINSZ9ehyF6Cz\"\n}).base(\"appiR8DpsnVuhNHj4\");\nconst entriesTable = base(\"Entries\");\nconst studentTable = base(\"Students\");\nimport React, { useContext } from \"react\";\nimport { AppContext } from \"../utils/AppContext\"; // url = AIRTABLE_API_URL + / + AIRTABLE_BASE_ID + / + tableName;\n\nconst PostData = (event, context) => {\n  const tableName = event.queryStringParameters.table; // if (event.httpMethod !== \"POST\") {\n  //     return { statusCode: 405, body: \"Method not allowed - please POST\" };\n  // }\n};\n\nconst minifyRecord = record => {\n  return {\n    id: record.id,\n    fields: record.fields\n  };\n};\n\nconst postStudent = async fields => {\n  const {\n    loginInfo,\n    setLoginInfo\n  } = useContext(AppContext);\n  const token = JSON.parse(localStorage.getItem(\"token\"));\n  console.log(\"loginInfo\", loginInfo); // console.log(fields);\n  // get user info from app context\n\n  try {\n    const createdRecord = await studentTable.create({\n      fields: {\n        Name: token.full_name,\n        Gender: fields.gender,\n        Email: token.email,\n        \"Current level\": 0,\n        DOB: fields.dob,\n        Country: fields.Country\n      }\n    });\n    console.log(minifyRecord(createdRecord));\n  } catch (err) {\n    console.error(err);\n  }\n};\n\nconst postEntries = async fields => {\n  try {\n    const createdRecord = await entriesTable.create(fields);\n    console.log(minifyRecord(createdRecord));\n  } catch (err) {\n    console.error(err);\n  }\n};\n\nexport { postStudent, postEntries };","map":{"version":3,"sources":["/home/hettiemcc/documents/fac/projects/teach-fish-frontend/src/utils/post-data.js"],"names":["Airtable","require","base","endpointUrl","apiKey","entriesTable","studentTable","React","useContext","AppContext","PostData","event","context","tableName","queryStringParameters","table","minifyRecord","record","id","fields","postStudent","loginInfo","setLoginInfo","token","JSON","parse","localStorage","getItem","console","log","createdRecord","create","Name","full_name","Gender","gender","Email","email","DOB","dob","Country","err","error","postEntries"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB,C,CAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;;AAEA,MAAMC,IAAI,GAAG,IAAIF,QAAJ,CAAa;AACxBG,EAAAA,WAAW,EAAE,0BADW;AAExBC,EAAAA,MAAM,EAAE;AAFgB,CAAb,EAGVF,IAHU,CAGL,mBAHK,CAAb;AAKA,MAAMG,YAAY,GAAGH,IAAI,CAAC,SAAD,CAAzB;AACA,MAAMI,YAAY,GAAGJ,IAAI,CAAC,UAAD,CAAzB;AAEA,OAAOK,KAAP,IAAgBC,UAAhB,QAAkC,OAAlC;AACA,SAASC,UAAT,QAA2B,qBAA3B,C,CAEA;;AAEA,MAAMC,QAAQ,GAAG,CAACC,KAAD,EAAQC,OAAR,KAAoB;AACnC,QAAMC,SAAS,GAAGF,KAAK,CAACG,qBAAN,CAA4BC,KAA9C,CADmC,CAGnC;AACA;AACA;AACD,CAND;;AAQA,MAAMC,YAAY,GAAIC,MAAD,IAAY;AAC/B,SAAO;AACLC,IAAAA,EAAE,EAAED,MAAM,CAACC,EADN;AAELC,IAAAA,MAAM,EAAEF,MAAM,CAACE;AAFV,GAAP;AAID,CALD;;AAOA,MAAMC,WAAW,GAAG,MAAOD,MAAP,IAAkB;AACpC,QAAM;AAAEE,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAA8Bd,UAAU,CAACC,UAAD,CAA9C;AACA,QAAMc,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAX,CAAd;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBR,SAAzB,EAHoC,CAIpC;AACA;;AACA,MAAI;AACF,UAAMS,aAAa,GAAG,MAAMxB,YAAY,CAACyB,MAAb,CAAoB;AAC9CZ,MAAAA,MAAM,EAAE;AACNa,QAAAA,IAAI,EAAET,KAAK,CAACU,SADN;AAENC,QAAAA,MAAM,EAAEf,MAAM,CAACgB,MAFT;AAGNC,QAAAA,KAAK,EAAEb,KAAK,CAACc,KAHP;AAIN,yBAAiB,CAJX;AAKNC,QAAAA,GAAG,EAAEnB,MAAM,CAACoB,GALN;AAMNC,QAAAA,OAAO,EAAErB,MAAM,CAACqB;AANV;AADsC,KAApB,CAA5B;AAUAZ,IAAAA,OAAO,CAACC,GAAR,CAAYb,YAAY,CAACc,aAAD,CAAxB;AACD,GAZD,CAYE,OAAOW,GAAP,EAAY;AACZb,IAAAA,OAAO,CAACc,KAAR,CAAcD,GAAd;AACD;AACF,CArBD;;AAuBA,MAAME,WAAW,GAAG,MAAOxB,MAAP,IAAkB;AACpC,MAAI;AACF,UAAMW,aAAa,GAAG,MAAMzB,YAAY,CAAC0B,MAAb,CAAoBZ,MAApB,CAA5B;AACAS,IAAAA,OAAO,CAACC,GAAR,CAAYb,YAAY,CAACc,aAAD,CAAxB;AACD,GAHD,CAGE,OAAOW,GAAP,EAAY;AACZb,IAAAA,OAAO,CAACc,KAAR,CAAcD,GAAd;AACD;AACF,CAPD;;AASA,SAASrB,WAAT,EAAsBuB,WAAtB","sourcesContent":["const Airtable = require(\"airtable\");\n\n// export REACT_APP_AIRTABLE_API_KEY=keyOIINSZ9ehyF6Cz\n// export REACT_APP_AIRTABLE_BASE_ID=appiR8DpsnVuhNHj4\n// export REACT_APP_AIRTABLE_API_URL=https://api.airtable.com/v0/\n\n// const {\n//   REACT_APP_AIRTABLE_API_KEY,\n//   REACT_APP_AIRTABLE_BASE_ID,\n//   REACT_APP_AIRTABLE_API_URL,\n// } = process.env;\n\nconst base = new Airtable({\n  endpointUrl: \"https://api.airtable.com\",\n  apiKey: \"keyOIINSZ9ehyF6Cz\",\n}).base(\"appiR8DpsnVuhNHj4\");\n\nconst entriesTable = base(\"Entries\");\nconst studentTable = base(\"Students\");\n\nimport React, { useContext } from \"react\";\nimport { AppContext } from \"../utils/AppContext\";\n\n// url = AIRTABLE_API_URL + / + AIRTABLE_BASE_ID + / + tableName;\n\nconst PostData = (event, context) => {\n  const tableName = event.queryStringParameters.table;\n\n  // if (event.httpMethod !== \"POST\") {\n  //     return { statusCode: 405, body: \"Method not allowed - please POST\" };\n  // }\n};\n\nconst minifyRecord = (record) => {\n  return {\n    id: record.id,\n    fields: record.fields,\n  };\n};\n\nconst postStudent = async (fields) => {\n  const { loginInfo, setLoginInfo } = useContext(AppContext);\n  const token = JSON.parse(localStorage.getItem(\"token\"));\n  console.log(\"loginInfo\", loginInfo);\n  // console.log(fields);\n  // get user info from app context\n  try {\n    const createdRecord = await studentTable.create({\n      fields: {\n        Name: token.full_name,\n        Gender: fields.gender,\n        Email: token.email,\n        \"Current level\": 0,\n        DOB: fields.dob,\n        Country: fields.Country,\n      },\n    });\n    console.log(minifyRecord(createdRecord));\n  } catch (err) {\n    console.error(err);\n  }\n};\n\nconst postEntries = async (fields) => {\n  try {\n    const createdRecord = await entriesTable.create(fields);\n    console.log(minifyRecord(createdRecord));\n  } catch (err) {\n    console.error(err);\n  }\n};\n\nexport { postStudent, postEntries };\n"]},"metadata":{},"sourceType":"module"}